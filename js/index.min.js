let map=L.map("map"),lamin=26.3978980576,lomin=80.0884245137,lamax=30.4227169866,lomax=88.1748043151;function getCustomData(success,error){let baseUrl,url=`${"https://opensky-network.org/api/states/all"}?lamin=${lamin}&lomin=${lomin}&lamax=${lamax}&lomax=${lomax}`;var xhr=new XMLHttpRequest;function convertToGeoJSON(input){"string"==typeof input&&(input=JSON.parse(input));for(var fs={type:"FeatureCollection",features:[]},i=0;i<input.states.length;i++){var ele=input.states[i],feature={type:"Feature",geometry:{type:"Point",coordinates:[ele[5],ele[6]]}};feature.properties=ele,feature.properties.id=i,isNumeric(ele[5])&&isNumeric(ele[6])&&fs.features.push(feature)}return console.log(fs),fs}function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}xhr.open("GET",url),xhr.onload=function(){if(200===xhr.status){var res=convertToGeoJSON(xhr.responseText);success(res)}else{var e=new Error("HTTP Rquest");error(e,xhr.status)}},xhr.send()}L.tileLayer("https://dev.{s}.tile.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png").addTo(map),planeIcon=L.icon({iconUrl:"css/plane-white.png",iconSize:[15,20]}),realtime=L.realtime(getCustomData,{interval:1e4}),realtime.on("update",(function(e){map.fitBounds(realtime.getBounds(),{maxZoom:13});const popupContent=function(fId){let feature=e.features[fId];return`<h3>Origin: ${feature.properties[2]}</h3>\n        <h3>Altitude:${feature.properties[7]} m</h3>\n        <h3>Velocity: ${feature.properties[9]} m/s</h3>`};Object.keys(e.enter).forEach(id=>{let layer=realtime.getLayer(id),coordinates=[layer.feature.geometry.coordinates[1],layer.feature.geometry.coordinates[0]],marker;L.marker(coordinates,{icon:planeIcon,rotationAngle:layer.feature.properties[10]-45}).addTo(map).bindPopup(popupContent(id))})}));